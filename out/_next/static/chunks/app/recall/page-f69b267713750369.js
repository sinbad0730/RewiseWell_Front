(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{69062:function(e,t,r){Promise.resolve().then(r.bind(r,38266))},38496:function(e,t,r){"use strict";r.d(t,{Ol:function(){return c},SZ:function(){return i},Zb:function(){return l},aY:function(){return d},ll:function(){return o}});var a=r(57437),s=r(2265),n=r(80824);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg bg-card text-card-foreground shadow-sm border-[1px] ",r),...s})});l.displayName="Card";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});c.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight text-white",r),...s})});o.displayName="CardTitle";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-white",r),...s})});i.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},93812:function(e,t,r){"use strict";r.d(t,{_:function(){return i}});var a=r(57437),s=r(2265),n=r(6394),l=r(90535),c=r(80824);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,c.cn)(o(),r),...s})});i.displayName=n.f.displayName},99404:function(e,t,r){"use strict";r.d(t,{g:function(){return l}});var a=r(57437),s=r(2265),n=r(80824);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground  focus-visible:ring-ring focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});l.displayName="Textarea"},38266:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var a=r(57437),s=r(2265),n=r(21837),l=r(83464),c=r(59628),o=r(99228),i=r(80513),d=r(91912),u=r(15943),m=r(73002),x=r(35801),h=r(38496),f=r(43643),p=r(80824);let g=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(f.fC,{ref:t,className:(0,p.cn)("relative overflow-hidden",r),...n,children:[(0,a.jsx)(f.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(b,{}),(0,a.jsx)(f.Ns,{})]})});g.displayName=f.fC.displayName;let b=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...n}=e;return(0,a.jsx)(f.gb,{ref:t,orientation:s,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...n,children:(0,a.jsx)(f.q4,{className:"relative flex-1 rounded-full bg-border"})})});b.displayName=f.gb.displayName;var j=r(51817),N=r(82222),y=r(79862);function v(e){let{message:t,isAI:r}=e;return(0,a.jsxs)("div",{className:(0,p.cn)("flex gap-4 p-4 transition-colors font-mono"),children:[(0,a.jsx)("div",{className:(0,p.cn)("h-8 w-8 rounded-full flex items-center justify-center flex-shrink-0",r?"bg-green-500/20":"bg-green-700/20"),children:r?(0,a.jsx)(N.Z,{className:"h-5 w-5 text-green-400"}):(0,a.jsx)(y.Z,{className:"h-5 w-5 text-green-500"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-400",children:r?"Agent":"You"}),(0,a.jsx)("div",{className:"prose prose-sm max-w-none text-white opacity-65",children:t})]})]})}function w(e){let{isLoading:t,answerResult:r}=e,n=(0,s.useRef)(null);return(0,s.useEffect)(()=>{var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[r]),(0,a.jsx)(g,{className:"flex-1 h-[calc(100%-120px)]",children:(0,a.jsxs)("div",{className:"divide-y divide-gray-700",children:[(null==r?void 0:r.length)>0&&r.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(v,{message:e.question,isAI:!1}),(0,a.jsx)(v,{message:e.feedback,isAI:!0})]},t)),t&&(0,a.jsx)("div",{className:"flex justify-center p-4",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 animate-spin text-white-100"})}),(0,a.jsx)("div",{ref:n})]})})}var k=r(51889),S=r(99404),C=r(82431),_=r(90245);function Z(e){let{userId:t,keyterms:r,unitName:n,messages:l,setMessages:c,setSubmits:o}=e,[i,d]=(0,s.useState)(l);return(0,a.jsx)("div",{className:"p-4 border-t border-green-700/30 bg-black",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(k.z,{type:"button",variant:"outline",onClick:()=>{d(""),c("")},className:"self-end border-green-700/30 text-green-400 hover:text-green-300 hover:bg-green-900/20",children:(0,a.jsx)(C.Z,{className:"h-5 w-5"})}),(0,a.jsx)(S.g,{value:i,onChange:e=>d(e.target.value),placeholder:"Ask about ".concat(""!==r?r:n," ..."),className:"min-h-[80px] bg-green-900/10 border-green-700/30 text-green-100 placeholder:text-green-700 resize-y font-mono"}),(0,a.jsx)(k.z,{onClick:()=>{i.trim()&&(c(i),o(!0),d(""))},className:"self-end bg-green-600 hover:bg-green-700",disabled:""===i,children:(0,a.jsx)(_.Z,{className:"h-5 w-5 text-white"})})]})})}var E=r(93812),F=(0,n.Z)(()=>{let[e,t]=(0,s.useState)(-1),[r,n]=(0,s.useState)(-1),[f,p]=(0,s.useState)(!1),[g,b]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[y,v]=(0,s.useState)(null),[k,S]=(0,s.useState)([]),[C,_]=(0,s.useState)([]),[F,I]=(0,s.useState)([]),R=JSON.parse(localStorage.getItem("authtoken")).access_token,T=JSON.parse(localStorage.getItem("authtoken")).user.id,[A,z]=(0,s.useState)([]),[B,O]=(0,s.useState)(!1),[P,U]=(0,s.useState)(!1),[q,L]=(0,s.useState)(""),[D,M]=(0,s.useState)(!1),[Y,J]=(0,s.useState)(""),[V,K]=(0,s.useState)(""),[W,G]=(0,s.useState)(null),[H,Q]=(0,s.useState)(!1),{TextArea:X}=i.default,[$,ee]=(0,s.useState)([]),[et,er]=(0,s.useState)(!1);(0,o.Z)(),(0,s.useEffect)(()=>{en()},[]),(0,s.useEffect)(()=>{ea(),b(""),p(!1)},[r,y]),(0,s.useEffect)(()=>{g.length>600&&b(g.slice(0,600))},[g]);let ea=async()=>{var t;let a=null==F?void 0:F.filter(e=>e.unit_id==r),s=-1!==e&&-1!==r&&(null===(t=a[0])||void 0===t?void 0:t.unit_name);await l.Z.get("".concat(c.C,"/mongo_questions?category=").concat(s,"&marks=").concat(0,"&limit=").concat(null===y?0:y))},es=async t=>{await l.Z.get("".concat(c.C,"/recall/get_recall_answers"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(R)},params:{subjectId:e,unitId:t,userId:T}}).then(async e=>{S(e.data),z(Array.isArray(e.data.messages)?e.data.messages:[])}).catch(e=>{console.log("Error getting recall feedback",e)})},en=async()=>{await l.Z.get("".concat(c.C,"/grade-retrieval/get_all_subject"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(R)}}).then(async e=>{_(e.data)}).catch(e=>{})},el=async(e,t)=>{try{return(await l.Z.get("".concat(c.C,"/grade-retrieval/get_unit_and_subject_names/").concat(e,"/").concat(t),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(R)}})).data}catch(e){return console.error("Error fetching unit and subject name:",e),null}};(0,s.useEffect)(()=>{H&&(Q(!1),ec())},[H]);let ec=async()=>{try{M(!0),await l.Z.post("".concat(c.C,"/recall/generate_recall_feedback_v3"),{question:A,answer:"",subjectId:e,unitId:r,userId:T,unitName:null==W?void 0:W.unitName,subjectName:null==W?void 0:W.subjectName},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(R)}}).then(async e=>{z(e=>[...e]),await es(r),M(!1)})}catch(e){console.log("error",e),M(!1)}},eo=e=>"number"==typeof e[0]?e.slice(-3):e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,3).map(e=>e.value||0),ei=async e=>{try{let t=(await l.Z.get("".concat(c.C,"/exam/get_exam_score/").concat(T,"/").concat(e),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(R)}})).data.filter(t=>t.subject_id===Number(e)&&t.student_id===Number(T));if(0===t.length)return console.warn("No notes found for the topic ".concat(e)),[];let r={};return t.forEach(e=>{r[e.unit_id]||(r[e.unit_id]=[]),r[e.unit_id].push(e.score)}),await Promise.all(Object.entries(r).map(async t=>{let[r,a]=t,s=eo(a),n=Math.ceil(s.reduce((e,t)=>e+t,0)/s.length),{unitName:l,subjectName:c}=await el(Number(r),e);return{subjectName:c||"Unknown Subject",unitName:l||"Unknown Unit",averageScore:Math.trunc(n),unitId:String(r)}}))}catch(e){return console.error("Error retrieving exam grades: ",e),[]}},ed=async()=>{er(!0);let e=[];try{for(let t of C){let r=(await ei(t.subject_id)).filter(e=>e.averageScore<70);e.push(...r)}ee(e.sort((e,t)=>e.averageScore-t.averageScore))}catch(e){console.error("Error searching for weak units:",e)}finally{er(!1)}};(0,s.useEffect)(()=>{C.length>0&&ed()},[C]);let eu=async(e,r,a)=>{try{G({unitName:r,subjectName:e}),n(Number(a)),t(Number(a)),await new Promise(e=>setTimeout(e,50)),setTimeout(()=>{let e=document.getElementById("chat-section");e?e.scrollIntoView({behavior:"smooth"}):console.warn("Chat section not found in DOM.")},150)}catch(e){console.error("Error:",e)}};return(0,s.useEffect)(()=>{-1!==r&&es(r)},[r]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col  items-center min-h-screen bg-background p-10",children:[(0,a.jsx)(d.Z,{open:B,onCancel:()=>O(!1),footer:null,children:(0,a.jsx)("div",{className:"tutorial-overlay rounded-md p-5",children:(0,a.jsxs)("div",{className:"tutorial-content space-y-2",children:[(0,a.jsx)("h2",{className:"text-xl text-center text-white",children:"Active Recall"}),(0,a.jsx)("iframe",{className:"w-full h-[315px]",src:"https://www.youtube.com/embed/ih490oNctRU",title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{id:"help",className:"py-2 px-4 dark:bg-blue-700 dark:text-white",onClick:()=>O(!1),children:"Got It!"})})]})})}),(0,a.jsx)(d.Z,{open:P,onCancel:()=>U(!1),footer:null,children:(0,a.jsx)("div",{className:"tutorial-overlay rounded-md p-5",children:(0,a.jsx)("div",{className:"tutorial-content space-y-2 ",children:(0,a.jsxs)(u.Z,{name:"KeyTerm",initialValues:{remember:!0},onFinish:e=>{console.log("Success:",e),(null==e?void 0:e.keyterm)&&L(e.keyterm),U(!1)},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",className:"flex flex-col gap-2 relative mt-6",children:[(0,a.jsx)(u.Z.Item,{label:"Enter a key term or topic you want to start with:",name:"keyterm",rules:[{required:!0,message:"Please input your KeyTerms!"}],children:(0,a.jsx)(X,{className:"h-7 rounded pl-3"})}),(0,a.jsx)(u.Z.Item,{label:null,children:(0,a.jsx)(m.ZP,{type:"primary",htmlType:"submit",className:"absolute bottom-0 right-0",children:"Submit"})})]})})})}),(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-primary",children:"Active Recall"}),(0,a.jsx)("button",{id:"help",className:"ml-2 px-[10px] rounded-full text-lg dark:bg-blue-700 dark:text-white",onClick:()=>O(!0),children:"?"})]}),(0,a.jsxs)(h.Zb,{className:" mx-auto bg-black/40 backdrop-blur-xl border border-white/10 shadow-2xl p-10 mt-10",children:[(0,a.jsx)(E._,{className:"text-lg font-medium text-emerald-300 mt-8 mx-auto",children:"Performance on Weak Topics"}),et?(0,a.jsx)("p",{className:"text-center text-gray-300 mt-4",children:"Loading performance..."}):$.length>0?(0,a.jsxs)("table",{className:"table-auto w-full mt-4 text-left border-collapse  rounded-md border border-[#232F40]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-[#232F40] rounded-md",children:[(0,a.jsx)("th",{className:"border border-[#232F40] px-4 py-2 text-[#F070B3]",children:"Subject"}),(0,a.jsx)("th",{className:"border border-[#232F40] px-4 py-2 text-[#F070B3]",children:"Unit"}),(0,a.jsx)("th",{className:"border border-[#232F40] px-4 py-2 text-[#F070B3]",children:"Average (%)"}),(0,a.jsx)("th",{className:"border border-[#232F40] px-4 py-2"})," "]})}),(0,a.jsx)("tbody",{className:"rounded-md",children:$.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"border border-[#232F40] px-4 py-2 text-white",children:e.subjectName}),(0,a.jsx)("td",{className:"border border-[#232F40] px-4 py-2 text-white",children:e.unitName}),(0,a.jsxs)("td",{className:"border border-[#232F40] px-4 py-2 text-white",children:[e.averageScore,"%"]}),(0,a.jsx)("td",{className:"border border-[#232F40] px-4 py-2",children:(0,a.jsx)("button",{className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition duration-300 focus:outline-none",onClick:()=>eu(e.subjectName,e.unitName,e.unitId),disabled:r===e.unitId,children:"Study"})})]},t))})]}):(0,a.jsx)("p",{className:"text-center text-gray-300 mt-4",children:"Congratulations! No weak topics found."})]}),-1!==r&&(0,a.jsx)("div",{id:"chat-section",className:"mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full rounded-lg",children:(0,a.jsxs)(h.Zb,{className:"h-[calc(100vh-12rem)] bg-black border-green-700/30",children:[(0,a.jsx)(w,{answerResult:k,isLoading:!1}),(0,a.jsx)(Z,{userId:T,keyterms:q,unitName:null==W?void 0:W.unitName,setMessages:z,messages:A,setSubmits:Q})]})})]}),D&&(0,a.jsx)("div",{className:"loader-overlay",children:(0,a.jsx)(x.Z,{size:18,color:"#dark:bg-blue-900"})}),!D&&(0,a.jsx)("div",{children:(0,a.jsx)("h1",{children:"Flashcard incorrectList"})})]})})},21837:function(e,t,r){"use strict";var a=r(57437),s=r(2265),n=r(76934),l=r(99376),c=r(35801);let o=e=>e.displayName||e.name||"Component";t.Z=e=>{let t=t=>{let[r,o]=(0,s.useState)(null),[i,d]=(0,s.useState)(!0),u=(0,l.useRouter)(),[m,x]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{(()=>{let e=localStorage.getItem("authtoken");if(e)try{let t=JSON.parse(e);o(t.user)}catch(e){console.error("Error parsing token:",e),o(null)}else o(null);d(!1)})()},[]),(0,s.useEffect)(()=>{i||r||(console.log("You must Log in"),u.push("/auth/login"))},[r,i,u]),i)?(0,a.jsx)("div",{className:"loader-overlay",children:(0,a.jsx)(c.Z,{size:5,color:"#ffffff"})}):r?(0,a.jsxs)("div",{children:[(0,a.jsx)(n.Z,{onLoginClick:()=>x(!0)}),(0,a.jsx)("div",{className:"pt-16",children:(0,a.jsx)(e,{...t,user:r,setUser:o})})]}):null};return t.displayName="WithAuth(".concat(o(e),")"),t}}},function(e){e.O(0,[5501,3301,4998,9485,1021,1498,2283,6934,2971,2117,1744],function(){return e(e.s=69062)}),_N_E=e.O()}]);